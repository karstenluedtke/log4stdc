
CC=cl
CPPFLAGS=-I. -Ilog4stdc \
	-DWIN32=1 -D_WIN32=1 \
	-DSTDC_HEADERS=1 \
	-DHAVE_ALLOCA_H=1 \
	-DHAVE_FCNTL_H=1 \
	-DHAVE_INTTYPES_H=1 \
	-DHAVE_MALLOC_H=1 \
	-DHAVE_MEMORY_H=1 \
	-DHAVE_STDDEF_H=1 \
	-DHAVE_STDINT_H=1 \
	-DHAVE_STDLIB_H=1 \
	-DHAVE_STRING_H=1 \
	-DHAVE__BOOL=1 \
	-DHAVE__LOCALTIME64=1 \
	-DHAVE__LOCALTIME64_S=1 \
	-DPACKAGE="log4stdc" \
	-DPACKAGE_BUGREPORT="bug-log4stdc@example.org" \
	-DPACKAGE_NAME="log4stdc" \
	-DPACKAGE_STRING="log4stdc 0.8.1" \
	-DPACKAGE_TARNAME="log4stdc" \
	-DPACKAGE_URL="" \
	-DPACKAGE_VERSION="0.8.1" \
	-DVERSION="0.8.1"
CFLAGS=
CXXFLAGS=-EHsc

HEADERS= \
	log4stdc/log4stdc.h \


OFILES= \
	log4stdc/l4sc_logprintf.obj \
	log4stdc/l4sc_vlog.obj \
	log4stdc/l4sc_log.obj \
	log4stdc/l4sc_logger_enabled.obj \
	log4stdc/l4sc_formatmsg.obj \
	log4stdc/logger.obj \
	log4stdc/appender.obj \
	log4stdc/fileappender.obj \
	log4stdc/layout.obj \
	log4stdc/logmessage.obj \
	log4stdc/propertyconfigurator.obj \
	log4stdc/object.obj \
	log4stdc/l4stdcpool.obj \
	log4stdc/l4sc_posix_mutex.obj \
	log4stdc/l4sc_win32_mutex.obj \
	log4stdc/xmlconfigurator.obj \


TESTS= \
	testlink.exe \
	examples/barefootc_log_redirect.exe \
	tests/log4stdc/configure.xml/level.exe \
	tests/log4stdc/configure.xml/largefile.exe \
	tests/log4stdc/configure.prop/level.exe \


all: log4stdc.lib
	echo "all is made"

log4stdc.lib: $(OFILES) $(HEADERS)
	lib $(OFILES) /OUT:$@

check: $(OFILES) $(HEADERS) $(TESTS)
	testlink.exe
	examples\barefootc_log_redirect.exe
	tests\log4stdc\configure.xml\level.exe
	tests\log4stdc\configure.xml\largefile.exe
	tests\log4stdc\configure.prop\level.exe
	echo "check done"

log4stdc/l4sc_logprintf.obj: log4stdc/l4sc_logprintf.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) -Fo$@ log4stdc/l4sc_logprintf.c

log4stdc/l4sc_vlog.obj: log4stdc/l4sc_vlog.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) -Fo$@ log4stdc/l4sc_vlog.c

log4stdc/l4sc_log.obj: log4stdc/l4sc_log.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) -Fo$@ log4stdc/l4sc_log.c

log4stdc/l4sc_logger_enabled.obj: log4stdc/l4sc_logger_enabled.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) -Fo$@ log4stdc/l4sc_logger_enabled.c

log4stdc/l4sc_formatmsg.obj: log4stdc/l4sc_formatmsg.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) -Fo$@ log4stdc/l4sc_formatmsg.c

log4stdc/logger.obj: log4stdc/logger.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) -Fo$@ log4stdc/logger.c

log4stdc/appender.obj: log4stdc/appender.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) -Fo$@ log4stdc/appender.c

log4stdc/fileappender.obj: log4stdc/fileappender.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) -Fo$@ log4stdc/fileappender.c

log4stdc/layout.obj: log4stdc/layout.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) -Fo$@ log4stdc/layout.c

log4stdc/logmessage.obj: log4stdc/logmessage.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) -Fo$@ log4stdc/logmessage.c

log4stdc/propertyconfigurator.obj: log4stdc/propertyconfigurator.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) -Fo$@ log4stdc/propertyconfigurator.c

log4stdc/object.obj: log4stdc/object.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) -Fo$@ log4stdc/object.c

log4stdc/l4stdcpool.obj: log4stdc/l4stdcpool.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) -Fo$@ log4stdc/l4stdcpool.c

log4stdc/l4sc_posix_mutex.obj: log4stdc/l4sc_posix_mutex.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) -Fo$@ log4stdc/l4sc_posix_mutex.c

log4stdc/l4sc_win32_mutex.obj: log4stdc/l4sc_win32_mutex.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) -Fo$@ log4stdc/l4sc_win32_mutex.c

log4stdc/xmlconfigurator.obj: log4stdc/xmlconfigurator.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) -Fo$@ log4stdc/xmlconfigurator.c

testlink.exe: \
		testlink.obj \
		log4stdc.lib
	$(CC) $(CFLAGS) $(CXXFLAGS) -Fe$@ testlink.obj log4stdc.lib log4stdc.lib

testlink.obj: testlink.cpp $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) $(CXXFLAGS) -Fo$@ testlink.cpp

examples/barefootc_log_redirect.exe: \
		examples/barefootc_log_redirect.obj \
		log4stdc.lib
	$(CC) $(CFLAGS) $(CXXFLAGS) -Fe$@ examples/barefootc_log_redirect.obj log4stdc.lib log4stdc.lib

examples/barefootc_log_redirect.obj: examples/barefootc_log_redirect.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) $(CXXFLAGS) -Fo$@ examples/barefootc_log_redirect.c

tests/log4stdc/configure.xml/level.exe: \
		tests/log4stdc/configure.xml/level.obj \
		log4stdc.lib
	$(CC) $(CFLAGS) $(CXXFLAGS) -Fe$@ tests/log4stdc/configure.xml/level.obj log4stdc.lib log4stdc.lib

tests/log4stdc/configure.xml/level.obj: tests/log4stdc/configure.xml/level.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) $(CXXFLAGS) -Fo$@ tests/log4stdc/configure.xml/level.c

tests/log4stdc/configure.xml/largefile.exe: \
		tests/log4stdc/configure.xml/largefile.obj \
		log4stdc.lib
	$(CC) $(CFLAGS) $(CXXFLAGS) -Fe$@ tests/log4stdc/configure.xml/largefile.obj log4stdc.lib log4stdc.lib

tests/log4stdc/configure.xml/largefile.obj: tests/log4stdc/configure.xml/largefile.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) $(CXXFLAGS) -Fo$@ tests/log4stdc/configure.xml/largefile.c

tests/log4stdc/configure.prop/level.exe: \
		tests/log4stdc/configure.prop/level.obj \
		log4stdc.lib
	$(CC) $(CFLAGS) $(CXXFLAGS) -Fe$@ tests/log4stdc/configure.prop/level.obj log4stdc.lib log4stdc.lib

tests/log4stdc/configure.prop/level.obj: tests/log4stdc/configure.prop/level.c $(HEADERS)
	$(CC) -c $(CPPFLAGS) $(CFLAGS) $(CXXFLAGS) -Fo$@ tests/log4stdc/configure.prop/level.c

